{% if session['jwt_token'] %}<!DOCTYPE html>
<html dir="ltr" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>MTs Al Huda Reban</title>
    <link rel="icon" type="image/png" sizes="16x16" href="/static/image/Logo MTs Al Huda Reban.webp" />
    <link rel="stylesheet" type="text/css" href="/static/assets/extra-libs/css-chart/css-chart.css" />
    <link rel="stylesheet" type="text/css" href="/static/assets/libs/quill/dist/quill.snow.css" />
    <link rel="stylesheet" type="text/css" href="/static/assets/libs/select2/dist/css/select2.min.css" />
    <link href="/static/dist/css/style.min.css" rel="stylesheet" />
    <link href="/static/assets/extra-libs/datatables.net-bs4/css/dataTables.bootstrap4.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/assets/libs/apexcharts/dist/apexcharts.css" />
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <style>
      .ql-align-right { text-align: right; }
      .ql-align-left { text-align: left; }
      .ql-align-center { text-align: center; }
      .ql-align-justify { text-align: justify; }
      .rata-kiri-mobile { text-align: right !important; }
      @media (max-width: 640px) { .rata-kiri-mobile { text-align: left !important; } .btn-info { margin-top: 5px; margin-bottom: 5px; } }
      .table-responsive { overflow-x: scroll; cursor: grab; }
      .table-responsive:active { cursor: grabbing; }
      .table-responsive::-webkit-scrollbar { height: 15px; }
      .table-responsive::-webkit-scrollbar-thumb { background-color: #888; border-radius: 10px; }
      .table-responsive::-webkit-scrollbar-track { background-color: #f1f1f1; }
      .table-responsive { scrollbar-color: #888 #f1f1f1; scrollbar-width: thick; }
      .table {margin-bottom: 0px;} 
      .shrink-logo {max-width: 70px !important;}
      /* Default size for larger screens */
      .responsive-svg {
        width: auto ; /* Keep the image responsive */
        height: 50px;    /* Maintain aspect ratio */
      }
      #main-wrapper[data-layout=vertical] .left-sidebar[data-sidebarbg=skin2] .sidebar-nav ul .sidebar-item.selected>.sidebar-link {
          color: #fff;
          background-color: linear-gradient(to right, #fbc2eb, #a6c1ee);
      }
    </style>
    
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.4.min.js" ></script>
    <script src="/static/assets/libs/jquery/dist/jquery.min.js" ></script>
    
    <!-- jQuery UI -->
    <script src="/static/assets/extra-libs/taskboard/js/jquery-ui.min.js" ></script>
    <!-- SEO Meta Tags -->
    
<meta name="description" content="MTs Al Huda Reban (NPSN 20364561) adalah MTs swasta di Padomasan, Reban, Batang. Berdiri sejak 2 Juni 1983, terakreditasi B, beralamat di Jl. Raya Padomasan No.17.">
<meta property="og:title" content="MTs Al Huda Reban">
<meta property="og:description" content="MTs Al Huda Reban adalah MTs swasta di Reban, Batang – akreditasi B, berdiri 1983.">
<meta property="og:image" content="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgQiBuvkfDZt_mbS5XyiKWtuXPxHvwjgaVVjfWCWzKkZche76KZxPIwh5d1Kb_2jwxeqiei_UK5ucjj1dDUNLm0k6VBtZIp9dcxJfe-aVvltPb24iLqFPLAfFJQ0OCpkTc/s220/Logo+MTs+Al+Huda+Reban.jpg">
<meta property="og:url" content="https://mtsalhudareban.blogspot.com/">

<!-- JSON-LD -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "EducationalOrganization",
  "name": "MTs Al Huda Reban",
  "npsn": "20364561",
  "address": {
    "@type": "PostalAddress",
    "streetAddress": "Jl. Raya Padomasan No. 17",
    "addressLocality": "Padomasan",
    "addressRegion": "Reban",
    "addressCountry": "ID",
    "postalCode": "51273"
  },
  "url": "https://mtsalhudareban.blogspot.com/",
  "logo": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgQiBuvkfDZt_mbS5XyiKWtuXPxHvwjgaVVjfWCWzKkZche76KZxPIwh5d1Kb_2jwxeqiei_UK5ucjj1dDUNLm0k6VBtZIp9dcxJfe-aVvltPb24iLqFPLAfFJQ0OCpkTc/s220/Logo+MTs+Al+Huda+Reban.jpg",
  "foundingDate": "1983-06-02",
  "legalName": "MTs Al Huda Reban",
  "department": {
    "@type": "EducationalOrganization",
    "name": "Madrasah Tsanawiyah",
    "accreditation": "B"
  },
  "founder": {
    "@type": "Organization",
    "name": "Kementerian Agama Republik Indonesia"
  },
  "sameAs": [
	"https://www.facebook.com/mtsalhudareban",
    "https://www.instagram.com/mtsalhuda_reban"
  ]
}
</script>


  <style>
  .main-loader {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: white;
    z-index: 9999;

    display: flex;
    align-items: center;
    justify-content: center;
  }

  .main-loader::after {
    content: "";
    width: 50px;
    height: 50px;
    border: 5px solid #ccc;
    border-top-color: #333;
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }

  @keyframes spin {
    to {
      transform: rotate(360deg);
    }
  }
</style>

    <!-- App Scripts -->
    <script src="/static/dist/js/app.min.js" ></script>
    <script src="/static/dist/js/app.init.stylish.js" ></script>
    <script src="/static/dist/js/app-style-switcher.js" ></script>
  
    <!-- Table -->
    <script src="/static/assets/extra-libs/datatables.net/js/jquery.dataTables.min.js"></script>
    {% block head %}{% endblock %}
</head>
<body style="!background-color:!linear-gradient(to right, #fbc2eb, #a6c1ee)!">
  <div class="main-loader"> </div>
    <div id="main-wrapper">
      <header class="topbar">
        <nav class="navbar top-navbar navbar-expand-md navbar-dark">
          <div class="navbar-header">
            <!-- This is for the sidebar toggle which is visible on mobile only -->
            <a
              class="nav-toggler waves-effect waves-light d-block d-md-none"
              href="javascript:void(0)"
              ><i class="ri-close-line ri-menu-2-line fs-6"></i
            ></a>
            
            <!--You can put here icon as well // <i class="wi wi-sunset"></i> //-->
            <!-- Dark Logo icon -->
            <!-- Light Logo icon -->
            <div class="">
            <center>
            <img
              src="/static/image/Logo MTs Al Huda Reban.webp"
              alt="homepage"
              style="width:100px"
              class="responsive-svg responsive-logo"
            />
            </center>
            </div>
            <a
              class="topbartoggler d-block d-md-none  waves-effect waves-light"
              href="javascript:void(0)"
              style="padding-left:100px"
              data-bs-toggle="collapse"
              data-bs-target="#navbarSupportedContent"
              aria-controls="navbarSupportedContent"
              aria-expanded="false"
              aria-label="Toggle navigation"
              ><i class="ri-more-line fs-6"></i
            ></a>
         
          </div>
          <!-- ============================================================== -->
          <!-- End Logo -->
          <!-- ============================================================== -->
          <div class="navbar-collapse collapse" id="navbarSupportedContent">
            <!-- ============================================================== -->
            <!-- toggle and nav items -->
            <!-- ============================================================== -->
            <ul class="navbar-nav me-auto">
              <!-- This is  -->
              <li class="nav-item">
                <a
                  class="nav-link sidebartoggler d-none d-md-block"
                  href="javascript:void(0)"
                  ><i data-feather="menu"></i
                ></a>
              </li>
              <!-- search -->
            </ul>
            <ul class="navbar-nav">
              <li class="nav-item dropdown profile-dropdown">
                <a
                  class="nav-link dropdown-toggle d-flex align-items-center"
                  href="#"
                  data-bs-toggle="dropdown"
                  aria-haspopup="true"
                  aria-expanded="false"
                >
                  <!--<img
                    src="/static/image/default_admin.jpg"
                    alt="user"
                    width="30"
                    class="profile-pic rounded-circle"
                  />-->
                  <div class="d-none d-md-flex">
                    <span class="ms-2">Hi, <span class="text-dark fw-bold">{{ session['username'] }}</span></span >
                    <span>
                      <i data-feather="chevron-down" class="feather-sm"></i>
                    </span>
                  </div>
                </a>
                <div
                  class="dropdown-menu dropdown-menu-end mailbox dropdown-menu-animate-up"
                  style="width: 50%"
                >
                  <ul class="list-style-none">
                    <li class="p-30 pt-0">
                      <div class="mt-4">
                        <a
                          class="btn btn-info text-white"
                          href="/keluar"
                        >
                          Logout
                        </a>
                      </div>
                    </li>
                  </ul>
                </div>
              </li>
            </ul>
          </div>
        </nav>
      </header>
      {% include "include/sidebar2.html" %}
      <div class="page-wrapper">
	  
    <div class="flash-message-container" style="padding: 30px; margin-left: auto; margin-right: auto; padding-bottom:0px;">
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            {% for category, message in messages %}
              <div class="alert alert-{{ category }}  alert-dismissible fade show " style="z-index: 999;" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
              </div>
            {% endfor %}
          {% endif %}
        {% endwith %}
      </div>
    {% if message_time == False %}
    {% else %}
      <script>
        // Auto-hide alert after 4 seconds
        setTimeout(() => {
          document.querySelectorAll('.alert').forEach(alert => {
            alert.classList.remove('show');
            alert.classList.add('fade');
            setTimeout(() => alert.remove(), 500); // remove after fade out
          });
        }, 4000);
      </script>
      {% endif %}
      {% block content %}{% endblock content %}  
		
    <!-- Modal Tambah -->
<div class="modal fade" id="tambahModal" tabindex="-1" aria-labelledby="tambahModalLabel" aria-hidden="true">
  <div class="modal-dialog  modal-lg">
    <div class="modal-content">
      
      <!-- Modal Header -->
      <div class="modal-header">
        <h5 class="modal-title" id="tambahModalLabel">Tambah {{title_data}}</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Tutup"></button>
      </div>

      <!-- Modal Body -->
      <div class="modal-body">
        <form id="tambahModalForm">
            {% block form_tambah %}
            {% endblock %}

          <!-- Modal Footer -->
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
            <button type="submit" id="tombolSubmit" class="btn btn-primary">Simpan </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
      </div>
      <footer class="footer text-center" id='copyright'>
      </footer>
    </div>
    <script src="/static/assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <!-- apps -->
    <script>
      function handleResponse(data,crud,url) { console.log(data); try { if (data.msg === "SUKSES") { alert("Sukses "+crud+" data"); window.location.href = url; } else { alert("Gagal "+crud+" data"); window.location.href = url; } } catch (error) { console.log(error); alert("Error: " + error); window.location.href = url; } }
    </script>
    <!-- slimscrollbar scrollbar JavaScript -->
    <script src="/static/assets/libs/perfect-scrollbar/dist/perfect-scrollbar.jquery.min.js"></script>
    <script src="/static/assets/extra-libs/sparkline/sparkline.js"></script>
    <!--Wave Effects -->
    <script src="/static/dist/js/waves.js"></script>
    <!--Menu sidebar -->
    <script src="/static/dist/js/sidebarmenu.js"></script>
    <!--Custom JavaScript -->
    <script src="/static/dist/js/feather.min.js"></script>
    <script src="/static/dist/js/custom.min.js"></script>
    <!-- This Page JS -->
    <script src="/static/assets/libs/apexcharts/dist/apexcharts.min.js"></script>
    <!-- Quill editor -->
    <script src="/static/assets/libs/quill/dist/quill.min.js"></script>
    <!-- page agenda js-->
    <script src="/static/assets/libs/moment/min/moment.min.js"></script>
    {% block js %}{% endblock js %}
    <script>
    document.addEventListener("DOMContentLoaded",function(){const t=document.querySelector(".topbartoggler"),e=document.querySelector(".responsive-logo");t&&e&&t.addEventListener("click",function(){e.classList.add("shrink-logo")})});
    </script>
    <script>
    var url=window.location+"",path=url.replace(window.location.protocol+"//"+window.location.host+"/",""),element=$("ul#sidebarnav a").filter(function(){var t=this.href.split("?")[0],e=url.split("?")[0],a=path.split("?")[0];return t===e||t===a});element.parentsUntil(".sidebar-nav").each(function(){if($(this).is("li")&&0!==$(this).children("a").length)$(this).children("a").addClass("active"),0===$(this).parent("ul#sidebarnav").length?$(this).addClass("active"):$(this).addClass("selected");else if(!$(this).is("ul")&&0===$(this).children("a").length)$(this).addClass("selected");else $(this).is("ul")&&$(this).addClass("in")}),element.addClass("active"),$("#sidebarnav a").on("click",function(){if(!$(this).hasClass("active"))$("ul",$(this).parents("ul:first")).removeClass("in"),$("a",$(this).parents("ul:first")).removeClass("active"),$(this).next("ul").addClass("in"),$(this).addClass("active");else $(this).hasClass("active")&&($(this).removeClass("active"),$(this).parents("ul:first").removeClass("active"),$(this).next("ul").removeClass("in"))}),$("#sidebarnav >li >a.has-arrow").on("click",function(t){t.preventDefault()}),($(window).width()>768||window.Touch)&&$(".scroll-sidebar").animate({scrollTop:$("#sidebarnav .sidebar-item.selected").offset().top-80},500);
    </script>
    <script>

    var tahunSaatIni=(new Date).getFullYear();document.getElementById("copyright").innerHTML=tahunSaatIni+" © All Rights Reserved";
    </script>
	

<script>
function openEditModal(id) {
$('#editModal-' + id).modal('show');
}
function closeEditModal(id) {
$('#editModal-' + id).modal('hide');
}

// AJAX for Delete Data (DELETE)
function deleteData(id) {
    if (!confirm('Yakin?')) return;
    const baseUrl = window.location.origin + window.location.pathname;
    $.ajax({
        url: baseUrl + '/hapus/' + id,
        type: 'DELETE',
        contentType: 'application/json',
        dataType: 'json',
		xhrFields: {
			withCredentials: true
		},
        success: function (response) {
            alert(response.msg || "Data Berhasil dihapus");
            window.location.reload();
        },
        error: function (xhr, status, error) {
            var errorTxt = "Server Error";
            if (xhr.responseJSON && xhr.responseJSON.error){
                errorTxt = xhr.responseJSON.error;
            }
            if (xhr.responseJSON && xhr.responseJSON.msg){
                errorTxt = xhr.responseJSON.msg;
            }
            alert(`Delete failed: ${errorTxt}`);
        }
    });
}

// AJAX for Tambah Data (POST)
document.getElementById("tombolSubmit").addEventListener("click", function(event) {
    event.preventDefault(); // Prevent default form submit
    const form = document.getElementById("tambahModalForm");
    const formData = new FormData(form);
    const data = {};
    let isValid = true;
    let firstInvalid = null;

    // Cek tiap elemen yang required
    [...form.elements].forEach(input => {
        if (input.hasAttribute("required")) {
            const value = input.value.trim ? input.value.trim() : input.value;
            if (!value) {
                isValid = false;
                firstInvalid = firstInvalid || input;
                input.classList.add("is-invalid");
            } else {
                input.classList.remove("is-invalid");
            }
        }
    });
    

    // Jika tidak valid, kasih alert dan fokus ke input pertama yang kosong
    if (!isValid) {
        alert("Harap lengkapi semua field yang wajib diisi.");
        firstInvalid && firstInvalid.focus();
        return;
    }

    // Ambil data dari FormData ke objek JS
    formData.forEach((value, key) => {
        data[key] = value.trim ? value.trim() : value;
    });

    // Ubah tampilan tombol jadi loading
    document.getElementById("tombolSubmit").disabled = true;
    document.getElementById("tombolSubmit").innerHTML = '<div class="spinner-border spinner-border-sm"></div>';

    const baseUrl = window.location.origin + window.location.pathname;

    $.ajax({
        url: baseUrl + '/tambah',
        type: 'POST',
        contentType: 'application/json',
        dataType: 'json',
        data: JSON.stringify(data),		
        xhrFields: {
            withCredentials: true
        },
        success: function (response) {
            document.getElementById("tombolSubmit").innerHTML = "Submit";
            document.getElementById("tombolSubmit").disabled = false;
            alert(response.msg || "Berhasil tambah data");
            window.location.reload();
        },
        error: function (xhr, status, error) {
            document.getElementById("tombolSubmit").disabled = false;
            document.getElementById("tombolSubmit").innerHTML = "Submit";
            var errorTxt = "Server Error";
            if (xhr.responseJSON && xhr.responseJSON.error){
                errorTxt = xhr.responseJSON.error;
            }
            if (xhr.responseJSON && xhr.responseJSON.msg){
                errorTxt = xhr.responseJSON.msg;
            }
            alert(`Submit failed: ${errorTxt}`);
        }
    });
});

</script>
 <script>
    // Tunggu sampai semua konten selesai dimuat
    window.addEventListener('load', function () {
      document.querySelector('.main-loader').style.display = 'none';
      document.getElementById('main-wrapper').style.display = 'block';
    });
  </script>
  <!-- Tambahkan ke <head> jika belum -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">

<script>
  document.querySelectorAll('.toggle-password').forEach(btn => {
    btn.addEventListener('click', function () {
      const input = this.closest('.input-group').querySelector('input[type="password"], input[type="text"]');
      const icon = this.querySelector('i');

      // Toggle password visibility
      if (input.type === 'password') {
        input.type = 'text';
        icon.classList.remove('bi-eye');
        icon.classList.add('bi-eye-slash');
      } else {
        input.type = 'password';
        icon.classList.remove('bi-eye-slash');
        icon.classList.add('bi-eye');
      }
    });
  });
</script>


  </body>
</html>
{% else %}
<!-- Jika jwt_token tidak ada -->
<script>
    window.location.href = "/";
</script>
{% endif %}